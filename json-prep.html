<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
</head>

<script>

// Using d3.map, d3.rollup, etc.



function nodify(d, i) {
	// Destringing, etc.
	// (+ changes types, returning 0 instead of null/missing)

// Not working :(
	// var strings = [d.avg, d.ctyp, d.pra, d.prb];
	// var stringsLength = strings.length;

	// for (i=0; i++; i<stringsLength) {
	// 	if (strings[i]==="") {
	// 		return NaN;
	// 	} else {
	// 		strings[i] = +strings[i];
	// 	}
	// };

	d.avg = +d.avg;
	d.pra = +d.pra;
	d.prb = +d.prb;

	return d;

}

function viz(data) {

	dataset = d3.nest()
				.key(function(d) { return d.div; })
				.key(function(d) { return d.itm; })
				.entries(data);

	console.log(dataset);

	// Then used Chrome dev tools to copy array of objects.
	// Saved into example-data/(blah)/alldata.json.

}

d3.csv("example-data/Price data from year 2003 to date/alldata.csv", nodify, viz);


</script>

</html>